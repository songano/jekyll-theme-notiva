<li
  class="category-item level-{{ include.level }}"
  data-category-id="{{ include.category.slug }}"
>
  <div class="flex items-center justify-between group">
    <a
      href="{{ site.baseurl }}/categories/{{ include.category.slug }}/"
      class="flex items-center gap-1 font-medium hover:text-primary transition-colors {% if include.level == 1 %}text-foreground{% else %}text-muted-foreground{% endif %}"
    >
      <p class="category-icon flex items-center justify-center">
        <!-- 폴더 아이콘 (기본: 닫힘 / expanded: 열림) -->
        <span class="block expanded:hidden group-hover:text-primary transition-colors">
          {% include components/shared/icon.html name="folder" class="size-5" %}
        </span>
        <span class="hidden expanded:block group-hover:text-primary transition-colors">
          {% include components/shared/icon.html name="folder-open" class="size-5" %}
        </span>
      </p>
      <p class="truncate">{{ include.category.name }}</p>
      <p class="text-muted-foreground/70 font-normal">({{ include.category.total_posts }})</p>
    </a>
    <button
      id="toggle-{{ include.category.slug }}"
      class="toggle-btn shrink-0 p-1 rounded-full hover:bg-accent transition-all duration-200"
      aria-label="Toggle category"
      type="button"
    >
      <span class="chevron-up block transform transition-transform duration-200">
        {% include components/shared/icon.html name="chevron-up" class="size-3.5 stroke-2 text-muted-foreground/70" %}
      </span>
    </button>
  </div>

  {% comment %} {% assign close_class = 'max-h-0 opacity-0' %} {% endcomment %}
  {% assign close_class = '' %}

  {% if include.category.direct_posts.size > 0 %}
    <ul class="{% if include.level == 1 %}pl-2{% else %}pl-4{% endif %} mt-0.5 mb-1 space-y-0.5 overflow-hidden post-list origin-top transition-all duration-200 ease-out {{ close_class }}">
      {% for post in include.category.direct_posts %}
        <li class="flex items-center py-1">
          <a
            href="{{ site.baseurl }}{{ post.url }}"
            class="flex items-center gap-1 text-muted-foreground hover:text-primary truncate transition-colors"
          >
            {% include components/shared/icon.html name="document-text" class="size-5 flex-shrink-0" %}
            <span class="truncate">{{ post.title }}</span>
          </a>
        </li>
      {% endfor %}
    </ul>
  {% endif %}

  {% if include.category.children.size > 0 %}
    <ul class="overflow-hidden subcategory-list origin-top transition-all duration-200 ease-out {{ close_class }} {% if include.level == 1 %}pl-2{% else %}pl-4{% endif %}">
      {% for child_pair in include.category.children %}
        {% assign child_name = child_pair[0] %}
        {% assign child = child_pair[1] %}
        {% assign next_level = include.level | plus: 1 %}
        {% include components/sidebar/category-item.html category=child level=next_level %}
      {% endfor %}
    </ul>
  {% endif %}
</li>
