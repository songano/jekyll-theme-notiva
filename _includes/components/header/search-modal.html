<!--
  * Search functionality for Notiva theme
  * Uses Simple Jekyll Search for fast and efficient search
  * https://github.com/christian-fei/Simple-Jekyll-Search
-->

<div
  aria-hidden="true"
  id="search-modal"
  class="fixed inset-0 z-50 justify-center px-4 py-40 bg-background/70 backdrop-blur-sm aria-hidden:hidden"
>
  <div class="search-container overflow-hidden mx-auto flex flex-col bg-background dark:bg-sidebar max-w-3xl w-full rounded-2xl min-h-48 max-h-full shadow-2xl">
    <header class="px-5 flex gap-2 items-center border-b border-border">
      {% include components/shared/icon.html name="search" %}
      <input
        type="text"
        id="search-input"
        autocomplete="off"
        class="search-input w-full h-14 focus:outline-0"
        placeholder="{{ "search.placeholder" | t }}"
      >
      <kbd class="hidden md:block text-xs bg-secondary px-2 py-1 rounded-sm">esc</kbd>
    </header>

    <div class="hidden md:block text-xs text-gray-500 my-1 px-4">
      {{ 'search.shortcut_tip' | t }}
    </div>

    <!-- Search Results -->
    <div id="search-results" class="search-results overflow-y-auto scrollbar-thin max-h-full min-h-32"></div>
  </div>
</div>

{% capture result_template %}
  <a href="{url}" class="search-result-item block p-4 hover:bg-secondary transition-colors">
    <h3 class="search-result-title text-base font-medium">{title}</h3>
    <div class="search-result-meta flex gap-2 text-sm text-muted-foreground mt-1">
      <span class="search-result-date">{date}</span>
      <span class="search-result-category bg-primary/10 text-primary rounded-full px-2 py-0.5 text-xs">{category}</span>
    </div>
    <p class="search-result-excerpt text-sm text-muted-foreground mt-2">{excerpt}</p>
  </a>
{% endcapture %}

{% capture no_results %}
  <div class="p-8 flex items-center flex-col text-muted-foreground gap-1">
    {% include components/shared/icon.html name="archive-box-x-mark" class="size-6" %}
    {{ "search.no_results" | t }}
  </div>
{% endcapture %}

<!-- Inline Jekyll Search Script -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const searchInput = document.getElementById('search-input');
    const resultsContainer = document.getElementById('search-results');

    SimpleJekyllSearch({
      searchInput,
      resultsContainer,
      json: '{{ '/assets/data/search.json' | relative_url }}',
      searchResultTemplate: '{{ result_template | strip_newlines }}',
      noResultsText: '{{ no_results }}',
    });
  });
</script>
